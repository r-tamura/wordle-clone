import{v as P}from"./vendor.7c75cad7.js";const T=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function s(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=s(o);fetch(o.href,r)}};T();function j(e={}){const{immediate:t=!1,onNeedRefresh:s,onOfflineReady:n,onRegistered:o,onRegisterError:r}=e;let a;const d=async(i=!0)=>{};return"serviceWorker"in navigator&&(a=new P("/sw.js",{scope:"/",type:"classic"}),a.addEventListener("activated",i=>{i.isUpdate?window.location.reload():n==null||n()}),a.register({immediate:t}).then(i=>{o==null||o(i)}).catch(i=>{r==null||r(i)})),d}j({onNeedRefresh(){},onOfflineReady(){}});const p=document.getElementById("grid"),S=document.getElementById("keyboard"),k="#222",C="#555",v="#888",$="#b59f3b",N="#538d4e",u={IN_PROGRESS:"IN_PROGRESS",WON:"WON",LOST:"LOST"};let l=[],c="",f=u.IN_PROGRESS,y=!1,m,B=[];function W(){for(let t=0;t<6;t++){const s=document.createElement("div");s.classList.add("row");for(let n=0;n<5;n++){const o=X();s.appendChild(o)}p.appendChild(s,"fast")}O();const e=l.map((t,s)=>x(s,"fast"));Promise.allSettled(e).then(()=>{b()})}function X(){const e=document.createElement("div");e.classList.add("flip-container"),e.classList.add("cell");const t=document.createElement("div");t.classList.add("flipper");const s=document.createElement("div");s.classList.add("front");const n=document.createElement("div");return n.classList.add("back"),e.appendChild(t),t.appendChild(s),t.appendChild(n),e}function O(){var t,s;const e=p.getElementsByClassName("row");for(let n=0;n<Math.min(l.length+1,6);n++){const r=e[n].getElementsByClassName("cell"),a=(t=l[n])!=null?t:c;for(let d=0;d<5;d++){const i=r[d],g=(s=a[d])!=null?s:"",[E,L]=i.querySelectorAll(".front, .back");E.textContent=g,L.textContent=g,E.backgroundColor=k,E.style.borderColor=g===""?C:v,L.style.backgroundColor=n===l.length?k:R(a,d)}}}function K(){const e=p.getElementsByClassName("row");Array.from(e).forEach((t,s)=>{const n=t.getElementsByClassName("cell");for(const o of n){const[r,a]=o.querySelectorAll(".front, .back");r.textContent="",r.style.borderColor="",r.style.backgroundColor="",a.textContent="",a.style.borderColor="",a.style.backgroundColor=""}})}function q(){const e=["qwertyuiop","$Sasdfghjkl$S","$Ezxcvbnm$B"];for(const t of e){const s=document.createElement("div");s.classList.add("row");let n;for(let o=0;o<t.length;o++){let r=["key"];t[o]==="$"?(o++,t[o]==="E"?(n=document.createElement("button"),n.textContent="Enter",r.push("enter")):t[o]==="B"?(n=document.createElement("button"),n.textContent="Back",r.push("backspace")):t[o]==="S"&&(n=document.createElement("div"),r.push("space","half"))):(n=document.createElement("button"),n.textContent=t[o]),n.classList.add(...r),n.addEventListener("click",z),s.appendChild(n)}S.appendChild(s)}}function b(){const e=new Map;for(const s of l)for(let n=0;n<s.length;n++){const o=s[n],r=R(s,n),a=e.get(o);a?e.set(o,M(r,a)):e.set(o,r)}const t=S.querySelectorAll(".key");for(const s of t){const n=s.textContent;if(!n)continue;const o=e.get(n);s.style.backgroundColor=o!=null?o:v}}function R(e,t){return m[t]===e[t]?N:m.includes(e[t])?$:C}function M(e,t){const s={[N]:2,[$]:1,[C]:0};return s[e]>s[t]?e:s[e]<s[t]?t:e}async function _(e,t){const n=p.getElementsByClassName("row")[e].getElementsByClassName("cell")[t],o=[{transform:"scale(0.9)"},{transform:"scale(1.1)",offset:.5},{transform:"scale(1.0)"}],r={duration:200};return await n.animate(o,r).finished}function F(e,t,{delay:s,duration:n,fill:o}){const d=p.getElementsByClassName("row")[e].getElementsByClassName("cell")[t].querySelector(".flipper"),i=[{transform:"rotateX(0deg)"},{transform:"rotateX(180deg)"}],g={duration:n,delay:s,fill:o,easing:"ease-out"};return d.animate(i,g)}async function x(e,t="slow",s="forwards"){if(!["slow","fast"].includes(t))throw Error("speed is required to be 'slow' or 'fast'");const n=[];for(let o=0;o<5;o++){const r=F(e,o,{duration:600,delay:o*(t==="slow"?400:100),fill:s});n.push(r)}return await Promise.all(n.map(o=>o.finished))}async function G(e){return await p.querySelectorAll(".row")[e].animate([{transform:"translateX(-2px)",offset:.1},{transform:"translateX(3px)",offset:.2},{transform:"translateX(-5px)",offset:.3},{transform:"translateX(5px)",offset:.4},{transform:"translateX(-5px)",offset:.5},{transform:"translateX(5px)",offset:.6},{transform:"translateX(-5px)",offset:.7},{transform:"translateX(3px)",offset:.8},{transform:"translateX(-2px)",offset:.9}],{duration:500}).finished}function Y(e){e.ctrlKey||e.metaKey||e.repeat||A(e.key)}function z(e){const t=e.target;A(t.textContent)}function A(e){if(f===u.WON||f===u.LOST||y)return;const t=c;if(/^[a-zA-Z]$/.test(e)){if(c.length===5)return;c+=e.toLowerCase()}else if(e==="Backspace"||e==="Back")c=c.slice(0,-1);else if(e==="Enter"){if(c.length<5){G(l.length).then(()=>{w("Not enough letters!")});return}if(!B.includes(c)){G(l.length).then(()=>{w("Not in word list")});return}l.push(c),c="",m===l.at(-1)?f=u.WON:l.length===6&&(f=u.LOST),Z(),y=!0,x(l.length-1,"slow").then(()=>{if(b(),f===u.WON){H();return}if(f===u.LOST){J();return}y=!1})}O(),t<c&&_(l.length,c.length-1)}function D(){const e=document.getElementById("app"),t=document.createElement("div");t.id="settings-page",t.classList.add("settings-page");const s=document.createElement("button");s.classList.add("button"),s.textContent="reset game",s.addEventListener("click",()=>{Q(),K(),b(),I()});const n=document.createElement("button");if(n.classList.add("button"),n.addEventListener("click",I),n.textContent="close",t.appendChild(s),h){const o=document.createElement("button");o.textContent="INSTALL",o.classList.add("button"),e.appendChild(o),o.addEventListener("click",async()=>{o.disabled=!0,h.prompt(),(await h.userChoice).outcome==="accepted"?console.log("App was installed"):console.log("App wasn't installed"),h=null}),t.appendChild(o)}t.appendChild(n),e.appendChild(t)}function I(){const e=document.getElementById("settings-page");e.parentElement.removeChild(e)}function w(e,{duration:t=2500}={}){const s=document.getElementById("app"),n=document.createElement("div");n.textContent=e,n.classList.add("snackbar"),n.style.opacity=0,setTimeout(()=>{n.style.opacity=1,setTimeout(()=>{n.style.opacity=0,setTimeout(()=>{n.parentElement.removeChild(n)},t+500)},t)}),s.appendChild(n)}function H(){w("Great!")}function J(){w(m.toUpperCase(),{duration:5e3})}function U(){const e=window.localStorage.getItem("state");if(e===null)return;({history:l,secret:m,gameState:f}=JSON.parse(e))}function Z(){window.localStorage.setItem("state",JSON.stringify({history:l,secret:m,gameState:f}))}function Q(){localStorage.clear(),l=[],c="",f=u.IN_PROGRESS,y=!1,location.reload()}let h;window.addEventListener("beforeinstallprompt",async e=>{console.log("BEFORE INSTALL PROMPT!!!!"),h=e});async function V(){return await Promise.allSettled([fetch("./data/word-list-5.json").then(t=>t.json()),fetch("./data/secret-word-list-5.json").then(t=>t.json())])}async function ee(){const[e,t]=await V();U();const s=e.value;if(B=[...s,...t.value],m===void 0){let n=Math.floor(Math.random()*s.length);m=s[n]}W(),q(),window.addEventListener("keydown",Y),document.getElementById("settings-button").addEventListener("click",D)}ee();
